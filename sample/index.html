<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Xumm Demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script data-consolejs-channel="6fbe1423-39bf-50d5-d9c2-12e2c27b9f30" src="https://remotejs.com/agent/agent.js"></script>
  </head>
  <body>
    <div class="container mt-2 px-4">
      <h1>Hello, world!</h1>

      <h1>
        <a href="/sample/index.html">Reload</a>
      </h1>

      <h2 class="mt-4">
        <button id="dpick">Destination Picker</button>
      </h2>

    </div>

    <script type="module">
      import '../dist/browser.js'

      let instance = 0

      const run = async () => {
        instance++
        const _instance = String(instance)

        const xumm = new Xumm('47fdfcb7-8362-47fe-9a89-a2efc55e86d5')
        await xumm.ready()

        console.log('xumm.getJwt@' + _instance, xumm.getJwt())
        console.log('xumm.getOttData@' + _instance, xumm.getOttData())
        console.log('xumm.getJwtData@' + _instance, xumm.getJwtData())

        document.getElementById('dpick').onclick = xumm.selectDestination;

        xumm.on('destination', data => {
          console.log('xapp-destination@' + _instance, data.destination?.name, data.destination?.address, data?.reason)
        })

        const pong = await xumm.ping()
        console.log('pong@' + _instance, pong)
      }

      run();

      setTimeout(function () {
        console.log('Run again')
        run();
      }, 5000)
    </script>
  </body>
</html>